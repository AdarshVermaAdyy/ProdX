<!-- <mat-sidenav-container class="sidenav-container"> -->
<div class="container-fluid d-flex">
    <div class="field-list-wrapper">

        <h4>Available Option</h4>
        <div *ngFor="let group of  getUniqueGroup(); let groupIndex = index">
           <div class="group-header">
            <mat-checkbox (change)="toggleSelectAll($event, group, groupIndex)">
                <h4 class="checkbox-list-heading">{{group | groupNamePipe}}</h4>
            </mat-checkbox>
        </div>
       
            <div *ngFor="let option  of optionalFieldsList; let i = index">
                <div *ngIf="option.group === group">
                    <mat-checkbox [checked]="option.selected" (change)="addRemoveControls($event.checked, option, i)"  class="group-option">
                        {{option.label}}
                    </mat-checkbox>
                </div>
            </div>
       
        </div>
    </div>

    <div class="form-wrapper">
        <form [formGroup]="dynamicForm" (ngSubmit)="onSubmit()">

            <!-- Dynamic Form Fields -->
            <div class="row">
                <!-- Product Boundary Condition -->
                <h2>Product Boundary Condition</h2>
                <!-- <p> Recived data : {{receivedshareData}}</p> -->
                <div formArrayName="selectedValues">
                    <div formArrayName="productBoundaryCondition">
                        <div class="row">
                            <div *ngFor="let field of productBoundaryCondition.controls; let i = index"
                                [formGroupName]="i" class="col-6">
                                <div [ngSwitch]="field.get('type')?.value">
                                    <div *ngSwitchCase="'range'">


                                        <div class="row">
                                            <!-- <div class="col-md-6"> -->
                                                <mat-form-field  class="col-md-6">
                                                    <mat-label>Min {{ field.get('label')?.value }}:</mat-label>
                                                    <!-- <label class="mat-label" for="min{{i}}">Min:</label> -->

                                                    <input matInput id="min{{i}}" type="number" formControlName="min" />

                                                    <mat-error *ngIf="field.get('min').invalid && (field.get('min')?.dirty || field.get('min').touched)">
                                                        <span *ngIf="field.get('min').errors?.['required']">This information is required.</span>
                                                    </mat-error>
                                                </mat-form-field>
                                            <!-- </div> -->

                                            <!-- <div class="col-md-6"> -->
                                                <mat-form-field class="col-md-6" >

                                                    <mat-label>Max {{ field.get('label')?.value }}:</mat-label>

                                                    <input matInput id="max{{i}}" type="number" formControlName="max" />

                                                    <mat-error *ngIf="field.get('max').invalid && (field.get('max')?.dirty || field.get('max').touched)">
                                                        <span *ngIf="field.get('max').errors?.['required']">This information is required.</span>
                                                    </mat-error>
                                                </mat-form-field>
                                            <!-- </div> -->
                                        </div>




                                    </div>

                                    <div *ngSwitchCase="'dropdown'">
                                        <!-- <div class="fromDropdown"> -->

                                        <mat-form-field class="dropdowidth">
                                            <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                            <mat-select formControlName="value">
                                                <mat-option *ngFor="let option of field.get('options')?.value"
                                                    [value]="option">{{ option }}</mat-option>
                                            </mat-select>
                                            
                                        </mat-form-field>
                                        <!-- </div> -->

                                    </div>

                                    <div *ngSwitchCase="'text'">
                                        <mat-form-field>
                                            <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                            <input matInput type="text" formControlName="value" />
                                        </mat-form-field>
                                    </div>

                                    <div *ngSwitchCase="'radio'">
                                        <!-- <mat-form-field> -->
                                        <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                        <mat-radio-group formControlName="value" class="radiobtgroup">
                                            <div *ngFor="let option of field.get('options')?.value">

                                                <mat-radio-button type="radio" [value]="option"> {{ option }}
                                                </mat-radio-button>
                                            </div>
                                        </mat-radio-group>
                                        <!-- </mat-form-field> -->

                                    </div>
                                </div>
                                <div
                                    *ngIf="field.get('value')?.invalid && (field.get('value')?.dirty || field.get('value')?.touched)">
                                    <div *ngIf="field.get('value')?.errors?.['required']">
                                        <span>This field is required</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Premium Details -->
                <div class="custom-divider mt-4"></div>
                <!-- <div class="custom-divider mt-4"></div> -->
                <h2>Product Service - Non-financial Alterations</h2>
                <div formArrayName="selectedValues">
                    <div formArrayName="premiumDetails">
                        <div class="row">
                            <div *ngFor="let field of premiumDetails.controls; let i = index" [formGroupName]="i"
                                class="col-6">
                                <div [ngSwitch]="field.get('type')?.value">
                                    <div *ngSwitchCase="'dropdown'">
                                        <mat-form-field class="dropdowidth">
                                           
                                            <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                            <mat-select formControlName="value">
                                                <mat-option *ngFor="let option of field.get('options')?.value"
                                                    [value]="option">{{ option }}</mat-option>
                                            </mat-select>
                                        </mat-form-field>

                                    </div>
                                    <div *ngSwitchCase="'radio'">
                                        <label>{{ field.get('label')?.value }}:</label>
                                        <div *ngFor="let option of field.get('options')?.value">
                                            <input matInput type="radio" [formControlName]="'value'" [value]="option" />
                                            {{ option }}
                                        </div>
                                    </div>
                                </div>
                                <div *ngIf="field.get('value')?.invalid && (field.get('value')?.dirty || field.get('value')?.touched)"
                                    class="text-danger">
                                    <div *ngIf="field.get('value')?.errors?.['required']">This field is required</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="custom-divider mt-4"></div>
                <h2> Forefeature/Reinstatement</h2>
                <div formArrayName="selectedValues">
                    <div formArrayName="featreandReinsate">
                        <div class="row">
                            <div *ngFor="let field of featreandReinsate.controls; let i = index" [formGroupName]="i"
                                class="col-6">
                                <div [ngSwitch]="field.get('type')?.value">
                                    <div *ngSwitchCase="'dropdown'">
                                        <mat-form-field class="dropdowidth">
                                            <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                            <mat-select formControlName="value">
                                                <mat-option *ngFor="let option of field.get('options')?.value"
                                                    [value]="option">{{ option }}</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div *ngSwitchCase="'radio'">
                                        <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                        <div *ngFor="let option of field.get('options')?.value">
                                            <input matInput type="radio" [formControlName]="'value'" [value]="option" />
                                            {{ option }}
                                        </div>
                                    </div>
                                </div>
                                <div
                                    *ngIf="field.get('value')?.invalid && (field.get('value')?.dirty || field.get('value')?.touched)">
                                    <div *ngIf="field.get('value')?.errors?.['required']">This field is required</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Product Servicing- Major Alterations -->
                <div class="custom-divider mt-4"></div>
                <h2>Product Servicing- Major Alterations</h2>
                <div formArrayName="selectedValues">
                    <div formArrayName="productServicingAlteration">
                        <div class="row">
                            <div *ngFor="let field of  productServicingAlteration.controls; let i = index"
                                [formGroupName]="i" class="col-6">
                                <div [ngSwitch]="field.get('type')?.value">

                                    <div *ngSwitchCase="'dropdown'">
                                        
                                            <ng-container *ngIf="field.get('label')?.value ==='Change of Gender'; else otherLabel">                            
                                                <mat-form-field class="dropdowidth"> 
                                                <mat-label>Change of Gender:</mat-label>
                                                    <mat-select formControlName="value" (openedChange)="onSelectedOpend($event)">
                                                        <mat-option *ngFor="let option of field.get('options')?.value"
                                                        [value]="option">{{ option }}</mat-option>
                                                    </mat-select>
                                                    <!-- for delete Gender -->
                                                     <!-- <mat-select formControlName="value" (openedChange)="openDialog(dialogTemplate,$event)">
                                                        <mat-option *ngFor="let option of field.get('options')?.value"
                                                        [value]="option">{{ option }}</mat-option>
                                                    </mat-select> -->
                                                </mat-form-field>  
                                            </ng-container>
                                            
                                            <ng-template #otherLabel>
                                                <mat-form-field class="dropdowidth"> 
                                            <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                            <mat-select formControlName="value">
                                                <mat-option *ngFor="let option of field.get('options')?.value"
                                                    [value]="option">{{ option }}</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        </ng-template>
                                        <ng-template #dialogTemplate>
                                            <h1 mat-dialog-title>Delete</h1>
                                            <div mat-dialog-content>
                                                <p>Are you want to delete</p>
                                            </div>
                                           <div mat-dialog-actions>
                                               <button mat-button (click)="dialog.closeAll()">Close</button>
                                               <button mat-button (click)="deleteGenderField()">Yes</button>
                                           </div>
                                        </ng-template>
                                      
                                    </div>
                                    <div *ngSwitchCase="'radio'">
                                        <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                        <div *ngFor="let option of field.get('options')?.value">
                                            <input matInput type="radio" [formControlName]="'value'" [value]="option" />
                                            {{ option }}
                                        </div>
                                    </div>
                                </div>
                                <div *ngIf="field.get('value')?.invalid && (field.get('value')?.dirty || field.get('value')?.touched)"
                                    class="text-danger">
                                    <div *ngIf="field.get('value')?.errors?.['required']">This field is required</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="custom-divider mt-4"></div>
                <!-- Termination/Cancellation/Claims -->

                <h2>Termination/Cancellation/Claims</h2>
                <div formArrayName="selectedValues">
                    <div formArrayName="terminationCancellation">
                        <div class="row">
                            <div *ngFor="let field of terminationCancellation.controls; let i = index"
                                [formGroupName]="i" class="col-6">
                                <div [ngSwitch]="field.get('type')?.value">
                                    <div *ngSwitchCase="'dropdown'">
                                        <mat-form-field class="dropdowidth">
                                            <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                            <mat-select formControlName="value">
                                                <mat-option *ngFor="let option of field.get('options')?.value"
                                                    [value]="option">{{ option }}</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div *ngSwitchCase="'radio'">
                                        <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                        <div *ngFor="let option of field.get('options')?.value">
                                            <input matInput type="radio" [formControlName]="'value'" [value]="option" />
                                            {{ option }}
                                        </div>
                                    </div>
                                </div>
                                <div *ngIf="field.get('value')?.invalid && (field.get('value')?.dirty || field.get('value')?.touched)"
                                    class="text-danger">
                                    <div *ngIf="field.get('value')?.errors?.['required']">This field is required</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

               <div *ngIf="isProducBoundarySelect()">
                <h2>prodcut Boundary</h2>
                <div formArrayName="selectedValues">
                    <div formArrayName="productBoundary">
                        <div class="row">
                            <div *ngFor="let field of productBoundary.controls; let i = index" [formGroupName]="i"
                                class="col-6">
                                <div [ngSwitch]="field.get('type')?.value">
                                    <div *ngSwitchCase="'dropdown'">
                                        <mat-form-field class="dropdowidth">
                                            <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                            <mat-select formControlName="value">
                                                <mat-option *ngFor="let option of field.get('options')?.value"
                                                    [value]="option">{{ option }}</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div *ngSwitchCase="'date'">
                                    <mat-form-field class="dropdowidth">
                                        <mat-label>{{field.get('label')?.value}}</mat-label>
                                        <input matInput [matDatepicker]="pickers" formControlName="value">
                                          <mat-datepicker-toggle matSuffix [for]="pickers"></mat-datepicker-toggle>
                                           <mat-datepicker #pickers></mat-datepicker>
                                        <!-- <mat-error *ngIf="coverageExpiryDate?.invalid && (coverageExpiryDate?.dirty || coverageExpiryDate?.touched)">
                                            <span *ngIf="coverageExpiryDate?.errors?.['required']">This information is required.</span>
                                        </mat-error> -->
                                    </mat-form-field>
                                    </div>
                                    <div *ngSwitchCase="'radio'">
                                        <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                        <div *ngFor="let option of field.get('options')?.value">
                                            <input matInput type="radio" [formControlName]="'value'" [value]="option" />
                                            {{ option }}
                                        </div>
                                    </div>
                                </div>
                                <div *ngIf="field.get('value')?.invalid && (field.get('value')?.dirty || field.get('value')?.touched)"
                                    class="text-danger">
                                    <div *ngIf="field.get('value')?.errors?.['required']">This field is required</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>

                <div *ngIf="isPremiumandPaymentDetailSelect()">
                    <h2>Premium And Payment Detail</h2>
                    <div formArrayName="selectedValues">
                        <div formArrayName="PremiumandPaymentDetail">
                            <div class="row">
                                <div *ngFor="let field of PremiumandPaymentDetail.controls; let i = index" [formGroupName]="i"
                                    class="col-6">
                                    <div [ngSwitch]="field.get('type')?.value">
                                        <div *ngSwitchCase="'dropdown'">
                                            <mat-form-field class="dropdowidth">
                                                <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                                <mat-select formControlName="value">
                                                    <mat-option *ngFor="let option of field.get('options')?.value"
                                                        [value]="option">{{ option }}</mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div *ngSwitchCase="'radio'">
                                            <mat-label>{{ field.get('label')?.value }}:</mat-label>
                                            <div *ngFor="let option of field.get('options')?.value">
                                                <input matInput type="radio" [formControlName]="'value'" [value]="option" />
                                                {{ option }}
                                            </div>
                                        </div>
                                    </div>
                                    <div *ngIf="field.get('value')?.invalid && (field.get('value')?.dirty || field.get('value')?.touched)"
                                        class="text-danger">
                                        <div *ngIf="field.get('value')?.errors?.['required']">This field is required</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>


            </div>
            <div class="form-btn-wrapper">
                <button  mat-flat-button color="primary" class="mt-3" [disabled]="dynamicForm.invalid">Save as Draft</button>
                <button  mat-flat-button color="primary" class="mt-3" matStepperPrevious>Back</button>
                <button  mat-flat-button color="primary" class="mt-3" matStepperNext [disabled]="dynamicForm.invalid">Next</button>
            </div>

        </form>
    </div>
</div>